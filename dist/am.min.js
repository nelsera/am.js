// am.js@v0.0.1, MIT licensed. https://github.com/adriancmiranda/am.js
!function(t,n,e){"use strict";function r(t,n){var e,r={};n="object"===m(n)?n:{};for(e in t)r[e]=(n.hasOwnProperty(e)?n:t)[e];return r}function o(t,n,e,r,o,a,i){var u,m,s,c,l,p=[];for(u=0;t>u;u++)s=i?~~(u/n):u%n,m=i?u%n:~~(u/n),c=Math.round(e+o)*s,l=Math.round(r+a)*m,p.push({column:s,row:m,x:0-c,y:0-l,frame:u,label:""});return p}function a(t){var n=(i(t,"backgroundPosition")||i(t,"backgroundPositionX")+" "+i(t,"backgroundPositionY")).replace(/left|top/gi,0).split(" ");return{x:F(n[0]),y:F(n[1])}}function i(n,e){return t.getComputedStyle?t.getComputedStyle(n,null)[e]:n.currentStyle[e]}function u(t,n){if(t===!1)return"Boolean";if(""===t)return"String";if(0===t)return"Number";if(t&&t.constructor){var e=(t.constructor.toString()||Object.prototype.toString.apply(t)).replace(/^.*function([^\s]*|[^\(]*)\([^\x00]+$/,"$1").replace(/^(\[object\s)|]$/g,"").replace(/\s+/,"")||"Object";return n===!0||/^(Boolean|RegExp|Number|String|Array|Date)$/.test(e)?e:"Object"}return t}function m(n,e){var r=typeof n;return n===!1?"boolean":""===n?"string":(n&&"object"===r&&(r=u(n,e),r=String(r).toLowerCase()),"number"===r&&!t.isNaN(n)&&t.isFinite(n)?e===!0&&t.parseFloat(n)===t.parseInt(n,10)?0>n?"int":"uint":"number":n?r:n)}function s(n,e){return n=t.parseFloat(n),n=t.isNaN(n)||!t.isFinite(n)?0:n,e===!0&&(n=t.parseInt(1e4*n,10)/1e4),n}function c(t){return"string"===m(t)?/^(true|(^[1-9][0-9]*$)$|yes|y|sim|s|on)$/gi.test(t):!!t}function l(t,n,e){return t=s(t),n=s(n),e=s(e),t>e?e:n>t?n:t}function p(t,n,e){return t=s(t),n=s(n),e=s(e),t%=e,s(n>t?t+e:t)}function f(t){return t=F(t),0>t?0:t}function F(n){return 0|t.parseInt(n,10)}!function(){var n,e,r,o,a,i;for(e=0,r=["ms","moz","webkit","o"],n=0;n<r.length&&!t.requestAnimationFrame;++n)o=r[n]+"RequestAnimationFrame",a=r[n]+"CancelAnimationFrame",i=r[n]+"CancelRequestAnimationFrame",t.requestAnimationFrame=t[o],t.cancelAnimationFrame=t[a]||t[i];t.requestAnimationFrame||(t.requestAnimationFrame=function(n,r){var o,a,i;return o=(new Date).getTime(),a=Math.max(0,16-(o-e)),i=t.setTimeout(function(){n(o+a,r)},a),e=o+a,i}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(n){t.clearTimeout(n)})}(),e.Sprite=function(n,e){function i(n,e,r){var o,a;if("function"===m(n))return"number"===m(e)&&(r=e,e=null),a=++A.animationID,r=1e3/l(r||10,1,60),A.animations[a]={timeout:0,rAF:0},o=Array.prototype.slice.call(arguments,0),o.splice(0,3),function i(){A.animations[a].timeout=t.setTimeout(function(){A.animations[a].rAF=t.requestAnimationFrame(i,e),n.apply(null,o)},r)}(),a}function u(n){m(A.animations[n])&&(t.clearTimeout(A.animations[n].timeout),t.cancelAnimationFrame(A.animations[n].rAF),delete A.animations[n])}function g(t){d.lastFrame=d.currentFrame,d.currentFrame=p(t,1,d.totalFrames),d.row=d.timeline[d.currentFrame-1].row,d.column=d.timeline[d.currentFrame-1].column,d.offsetX=d.timeline[d.currentFrame-1].x+S.x,d.offsetY=d.timeline[d.currentFrame-1].y+S.y,d.element.style.backgroundPosition=d.offsetX+"px "+d.offsetY+"px"}function y(){"function"==typeof w.onUpdate&&w.onUpdate.apply(d,w.onUpdateParams),d.currentFrame<d.targetFrame?g(d.currentFrame+b):d.currentFrame>d.targetFrame?g(d.currentFrame+b):d.currentFrame===d.targetFrame&&(d.looping?d.yoyo?d.loopBetween(d.currentFrame,d.targetNextFrame,d.yoyo,w):d.loopBetween(d.targetNextFrame,d.currentFrame,d.yoyo,w):(d.pause(),"function"==typeof w.onComplete&&w.onComplete.apply(d,w.onCompleteParams)))}var d=this,A=d.constructor.static,S=a(n),b=1,v=null,w={};d.id=A.instances++,d.name="AM[Sprite_"+d.id+"]",d.element=n,d.options=r(A.defaults,e),d.fps=s(d.options.fps),d.totalFrames=Math.max(1,d.options.totalFrames-1),d.currentFrame=l(d.options.currentFrame,1,d.totalFrames),d.vertical=c(d.options.vertical),d.tileW=s(d.options.tileW)||n.clientWidth,d.tileH=s(d.options.tileH)||n.clientHeight,d.columns=f(d.options.columns),d.rows=f(d.options.rows),d.column=s(d.currentFrame%d.rows),d.row=~~(d.currentFrame/d.columns),d.timeline=o(d.totalFrames,d.vertical?d.rows:d.columns,d.tileW,d.tileH,0,0,d.vertical),d.lastFrame=d.currentFrame,d.targetNextFrame=0,d.targetFrame=0,d.offsetX=0,d.offsetY=0,d.reverse=!1,d.running=!1,d.looping=!1,d.yoyo=!1,d.play=function(t,n){d.pause(),"uint"===m(t,!0)?(w="object"===m(n)?n:{},d.targetFrame=l(t,1,d.totalFrames),d.reverse=d.currentFrame>d.targetFrame,b=d.reverse?-1:1,"function"==typeof w.onInit&&w.onInit.apply(d,w.onInitParams)):d.targetFrame=0,v=i(y,d.element,d.fps),d.running=!0,"function"==typeof w.onStart&&w.onStart.apply(d,w.onStartParams)},d.pause=function(){u(v),v=null,d.running=!1},d.togglePause=function(){d[v?"pause":"play"]()},d.stop=function(){g(0),d.pause(),d.running=!1},d.playToBeginAndStop=function(){d.play(0)},d.playToEndAndStop=function(){d.play(d.totalFrames)},d.gotoRandomFrame=function(){d.gotoAndStop(~~(Math.random()*d.totalFrames))},d.gotoAndPlay=function(t){g(t),d.play(),d.running=!0},d.gotoAndStop=function(t){g(t),d.pause(),d.running=!1},d.nextFrame=function(){d.jumpFrames(1),d.running=!1},d.prevFrame=function(){d.jumpFrames(-1),d.running=!1},d.jumpFrames=function(t){d.gotoAndStop(d.currentFrame+F(t))},d.loopBetween=function(t,n,e,r){t=l(t,1,d.totalFrames),n=l(n,0,d.totalFrames),d.gotoAndStop(t),d.running=!0,d.looping=!0,d.yoyo=c(e),d.targetNextFrame=t,0===n&&(n=d.totalFrames),d.play(n,r)},d.cancelLooping=function(){d.running=!1,d.looping=!1,d.yoyo=!1}},e.Sprite.static={instances:0,animationID:0,animations:{},defaults:{fps:24,totalFrames:1,currentFrame:1,vertical:!1,tileW:0,tileH:0,columns:0,rows:0}}}(this,this.document,this.AM=this.AM||{});