// am.js@v0.0.1, MIT licensed. https://github.com/adriancmiranda/am.js
!function(t,n,e){"use strict";function r(t,n){var e,r={};n="object"===c(n)?n:{};for(e in t)r[e]=(n.hasOwnProperty(e)?n:t)[e];return r}function o(t,n,e,r,o,a,i){var u,m,c,s,l,p=[];for(u=0;t>u;u++)c=i?~~(u/n):u%n,m=i?u%n:~~(u/n),s=Math.round(e+o)*c,l=Math.round(r+a)*m,p.push({column:c,row:m,x:0-s,y:0-l,frame:u,label:""});return p}function a(t){var n=(u(t,"backgroundPosition")||u(t,"backgroundPositionX")+" "+u(t,"backgroundPositionY")).replace(/left|top/gi,0).split(" ");return{x:F(n[0]),y:F(n[1])}}function i(t){var n=u(t,"backgroundImage")||"";return n.replace(/url\(|\)|"|'/g,"")}function u(n,e){return t.getComputedStyle?t.getComputedStyle(n,null)[e]:n.currentStyle[e]}function m(t,n){if(t===!1)return"Boolean";if(""===t)return"String";if(0===t)return"Number";if(t&&t.constructor){var e=(t.constructor.toString()||Object.prototype.toString.apply(t)).replace(/^.*function([^\s]*|[^\(]*)\([^\x00]+$/,"$1").replace(/^(\[object\s)|]$/g,"").replace(/\s+/,"")||"Object";return n===!0||/^(Boolean|RegExp|Number|String|Array|Date)$/.test(e)?e:"Object"}return t}function c(n,e){var r=typeof n;return n===!1?"boolean":""===n?"string":(n&&"object"===r&&(r=m(n,e),r=String(r).toLowerCase()),"number"===r&&!t.isNaN(n)&&t.isFinite(n)?e===!0&&t.parseFloat(n)===t.parseInt(n,10)?0>n?"int":"uint":"number":n?r:n)}function s(n,e){return n=t.parseFloat(n),n=t.isNaN(n)||!t.isFinite(n)?0:n,e===!0&&(n=t.parseInt(1e4*n,10)/1e4),n}function l(t){return"string"===c(t)?/^(true|(^[1-9][0-9]*$)$|yes|y|sim|s|on)$/gi.test(t):!!t}function p(t,n,e){return t=s(t),n=s(n),e=s(e),t>e?e:n>t?n:t}function f(t,n,e){return t=s(t),n=s(n),e=s(e),t%=e,s(n>t?t+e:t)}function g(t){return t=F(t),0>t?0:t}function F(n){return 0|t.parseInt(n,10)}!function(){var n,e,r,o,a,i;for(e=0,r=["ms","moz","webkit","o"],n=0;n<r.length&&!t.requestAnimationFrame;++n)o=r[n]+"RequestAnimationFrame",a=r[n]+"CancelAnimationFrame",i=r[n]+"CancelRequestAnimationFrame",t.requestAnimationFrame=t[o],t.cancelAnimationFrame=t[a]||t[i];t.requestAnimationFrame||(t.requestAnimationFrame=function(n,r){var o,a,i;return o=(new Date).getTime(),a=Math.max(0,16-(o-e)),i=t.setTimeout(function(){n(o+a,r)},a),e=o+a,i}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(n){t.clearTimeout(n)})}(),e.Sprite=function(n,e){function u(n,e,r){var o,a;if("function"===c(n))return"number"===c(e)&&(r=e,e=null),a=++b.animationID,r=1e3/p(r||10,1,60),b.animations[a]={timeout:0,rAF:0},o=Array.prototype.slice.call(arguments,0),o.splice(0,3),function i(){b.animations[a].timeout=t.setTimeout(function(){b.animations[a].rAF=t.requestAnimationFrame(i,e),n.apply(null,o)},r)}(),a}function m(n){c(b.animations[n])&&(t.clearTimeout(b.animations[n].timeout),t.cancelAnimationFrame(b.animations[n].rAF),delete b.animations[n])}function y(t){A.lastFrame=A.currentFrame,A.currentFrame=f(t,1,A.totalFrames),A.row=A.timeline[A.currentFrame-1].row,A.column=A.timeline[A.currentFrame-1].column,A.offsetX=A.timeline[A.currentFrame-1].x+A.image.x,A.offsetY=A.timeline[A.currentFrame-1].y+A.image.y,A.element.style.backgroundPosition=A.offsetX+"px "+A.offsetY+"px"}function d(){"function"==typeof x.onUpdate&&x.onUpdate.apply(A,x.onUpdateParams),A.currentFrame<A.targetFrame?y(A.currentFrame+v):A.currentFrame>A.targetFrame?y(A.currentFrame+v):A.currentFrame===A.targetFrame&&(A.looping?A.yoyo?A.loopBetween(A.currentFrame,A.targetNextFrame,A.yoyo,x):A.loopBetween(A.targetNextFrame,A.currentFrame,A.yoyo,x):(A.pause(),"function"==typeof x.onComplete&&x.onComplete.apply(A,x.onCompleteParams)))}var A=this,b=A.constructor.static,h=a(n),S=i(n),v=1,w=null,x={};A.id=b.instances++,A.name="AM[Sprite_"+A.id+"]",A.element=n,A.image={url:S,x:h.x,y:h.y,object:new Image},A.options=r(b.defaults,e),A.fps=s(A.options.fps),A.totalFrames=Math.max(1,A.options.totalFrames-1),A.currentFrame=p(A.options.currentFrame,1,A.totalFrames),A.vertical=l(A.options.vertical),A.tileW=s(A.options.tileW)||n.clientWidth,A.tileH=s(A.options.tileH)||n.clientHeight,A.columns=g(A.options.columns),A.rows=g(A.options.rows),A.column=s(A.currentFrame%A.rows),A.row=~~(A.currentFrame/A.columns),A.timeline=o(A.totalFrames,A.vertical?A.rows:A.columns,A.tileW,A.tileH,0,0,A.vertical),A.lastFrame=A.currentFrame,A.targetNextFrame=0,A.targetFrame=0,A.offsetX=0,A.offsetY=0,A.reverse=!1,A.running=!1,A.looping=!1,A.yoyo=!1,A.load=function(t){t="object"===c(t)?t:{},A.image.object.src=A.image.url,A.image.object.onload=function(){A.image.width=A.image.object.width,A.image.height=A.image.object.height,"function"==typeof t.onLoad&&t.onLoad.apply(A,t.onLoadParams)}},A.play=function(t,n){A.pause(),"uint"===c(t,!0)?(x="object"===c(n)?n:{},A.targetFrame=p(t,1,A.totalFrames),A.reverse=A.currentFrame>A.targetFrame,v=A.reverse?-1:1,"function"==typeof x.onInit&&x.onInit.apply(A,x.onInitParams)):A.targetFrame=0,w=u(d,A.element,A.fps),A.running=!0,"function"==typeof x.onStart&&x.onStart.apply(A,x.onStartParams)},A.pause=function(){m(w),w=null,A.running=!1},A.togglePause=function(){A[w?"pause":"play"]()},A.stop=function(){y(0),A.pause(),A.running=!1},A.playToBeginAndStop=function(t){A.play(0,t)},A.playToEndAndStop=function(t){A.play(A.totalFrames,t)},A.gotoRandomFrame=function(){A.gotoAndStop(~~(Math.random()*A.totalFrames))},A.gotoAndPlay=function(t){y(t),A.play(),A.running=!0},A.gotoAndStop=function(t){y(t),A.pause(),A.running=!1},A.nextFrame=function(){A.jumpFrames(1),A.running=!1},A.prevFrame=function(){A.jumpFrames(-1),A.running=!1},A.jumpFrames=function(t){A.gotoAndStop(A.currentFrame+F(t))},A.loopBetween=function(t,n,e,r){t=p(t,1,A.totalFrames),n=p(n,0,A.totalFrames),A.gotoAndStop(t),A.running=!0,A.looping=!0,A.yoyo=l(e),A.targetNextFrame=t,0===n&&(n=A.totalFrames),A.play(n,r)},A.cancelLooping=function(){A.running=!1,A.looping=!1,A.yoyo=!1}},e.Sprite.static={instances:0,animationID:0,animations:{},defaults:{fps:24,totalFrames:1,currentFrame:1,vertical:!1,tileW:0,tileH:0,columns:0,rows:0}}}(this,this.document,this.AM=this.AM||{});